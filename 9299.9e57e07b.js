"use strict";(self.webpackChunkkafka_ui=self.webpackChunkkafka_ui||[]).push([[9299],{55140:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(54025),a=function(){return a=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},a.apply(this,arguments)};const o=function(e){var t,i=(0,n.useScalprum)(),o=(null===(t=i.api)||void 0===t?void 0:t.chrome)||{};return o=a(a({},o),{initialized:i.initialized}),"function"==typeof e?e(o):o}},29299:(e,t,i)=>{i.d(t,{e:()=>D});var n=i(85893),a=i(93264),o=i(73685),s=i(97644),c=i(15847),r=i(3669);const l=({isSwitchChecked:e,setIsSwitchChecked:t,kafkaName:i,kafkaPageLink:a,kafkaInstanceLink:s})=>{const{t:l}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]),d=(0,n.jsxs)(r.Breadcrumb,Object.assign({ouiaId:"breadcrumb"},{children:[(0,n.jsx)(r.BreadcrumbItem,{render:()=>(0,n.jsx)(o.Link,Object.assign({to:a||"#"},{children:l("common.kafka_instance")}))}),(0,n.jsx)(r.BreadcrumbItem,{render:()=>(0,n.jsx)(o.Link,Object.assign({to:s||"#"},{children:i||l("common.kafka_instance_name")}))}),(0,n.jsx)(r.BreadcrumbItem,Object.assign({to:"#",isActive:!0},{children:l("topic.create_topic")}))]}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("section",Object.assign({className:"pf-c-page__main-breadcrumb"},{children:d})),(0,n.jsxs)(r.PageSection,Object.assign({variant:r.PageSectionVariants.light},{children:[(0,n.jsx)(r.Title,Object.assign({headingLevel:"h1",size:"2xl"},{children:l("topic.create_topic")})),(0,n.jsx)("br",{}),(0,n.jsx)(r.Switch,{ouiaId:"toggle-switch-off",id:"simple-switch",label:l("topic.show_all_options"),labelOff:l("topic.show_all_options"),isChecked:e,onChange:t,className:"create-topic-wizard"})]}))]})};var d=i(87967),m=i(55140),p=i(56637);i(17293);const u=({topicData:e,setTopicData:t,topicNameValidated:i,setTopicNameValidated:o,invalidText:s,setInvalidText:l})=>{const{t:d}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]),{validateName:m}=(0,p.N)(),u=e&&e.name,j=(0,a.useCallback)((e=>{const t=m(e);t?(l(t),o("error")):o("default")}),[l,o,m]);(0,a.useEffect)((()=>{j(u)}),[e.name,u,j]);return(0,n.jsx)(r.Form,Object.assign({onSubmit:e=>e.preventDefault()},{children:(0,n.jsxs)(r.FormSection,Object.assign({title:d("topic.topic_name"),id:"topic-name",titleElement:"h2"},{children:[(0,n.jsxs)(r.TextContent,{children:[(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.p},{children:d("topic.topic_name_info")})),(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.small},{children:d("topic.topic_name_info_note")}))]}),(0,n.jsx)(r.FormGroup,Object.assign({label:d("topic.topic_name"),fieldId:"step-topic-name-form",helperText:d("topic.topic_name_helper_text"),helperTextInvalid:s,validated:i,isRequired:!0},{children:(0,n.jsx)(r.TextInput,{ouiaId:"text-input",isRequired:!0,type:"text",id:"step-topic-name-input",name:"step-topic-name",value:u,onChange:i=>{j(i),t(Object.assign(Object.assign({},e),{name:i}))},placeholder:d("topic.enter_name"),validated:i})}))]}))}))};var j=i(86737);const x=({topicData:e,setTopicData:t})=>{const{t:i}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]),a=e&&e.numPartitions;return(0,n.jsx)(r.Form,{children:(0,n.jsxs)(r.FormSection,Object.assign({title:i("topic.partitions"),id:"partitions",titleElement:"h2"},{children:[(0,n.jsxs)(r.TextContent,{children:[(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.p},{children:i("topic.partition_info")})),(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.small},{children:i("topic.partition_info_note")}))]}),(0,n.jsx)(r.FormGroup,Object.assign({label:"Partitions",fieldId:"step-topic-name-form",helperText:i("topic.partition_helper_text"),isRequired:!0},{children:(0,n.jsx)(r.NumberInput,{onPlus:()=>{t(Object.assign(Object.assign({},e),{numPartitions:String(Number(e.numPartitions)+1)}))},onMinus:()=>{t(Object.assign(Object.assign({},e),{numPartitions:String(Number(e.numPartitions)-1)}))},value:Number(a),inputName:"input",onChange:i=>{let n=Number(i.target.value);n<j.jR?n=j.jR:n>j.TE&&(n=j.TE),t(Object.assign(Object.assign({},e),{numPartitions:String(n)}))},widthChars:20,min:j.jR,max:j.TE})}))]}))})};var h=i(92249),b=i(1787),g=i(93353);const T=({topicData:e,setTopicData:t})=>{const{t:i}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]),[o,s]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),m=i=>{t(Object.assign(Object.assign({},e),{"retention.ms":i===b.UC.UNLIMITED||i===b.UC.CUSTOM?e["retention.ms"]:`${b.yN[i]}`,selectedRetentionTimeOption:i}))},p=i=>{t(Object.assign(Object.assign({},e),{"retention.bytes":i===b.KP.UNLIMITED||i===b.KP.CUSTOM?e["retention.bytes"]:`${b.AV[i]}`,selectedRetentionSizeOption:i}))};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(r.Form,Object.assign({onSubmit:e=>e.preventDefault()},{children:(0,n.jsxs)(r.FormSection,Object.assign({title:i("topic.message_retention"),id:"message-retention",titleElement:"h2"},{children:[(0,n.jsxs)(r.TextContent,{children:[(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.p},{children:i("topic.message_retention_info")})),(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.small},{children:i("topic.message_retention_info_note")}))]}),(0,n.jsx)(r.FormGroup,Object.assign({fieldId:"form-group-retention-time-in-wizard",label:i("topic.retention_time")},{children:(0,n.jsxs)(r.Stack,Object.assign({hasGutter:!0},{children:[(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionTimeOption===b.UC.DAY,name:"radioDay",onChange:()=>m(b.UC.DAY),label:"A day","aria-label":"A day",id:"radio-controlled-1",value:b.UC.DAY}),(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionTimeOption===b.UC.WEEK,name:"radioWeek",onChange:()=>m(b.UC.WEEK),label:"A week","aria-label":"A week",id:"radio-controlled-2",value:b.UC.WEEK}),(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionTimeOption===b.UC.CUSTOM,name:"radioCustomTime",onChange:()=>m(b.UC.CUSTOM),label:"Custom duration","aria-label":"custom input",id:"radio-controlled-4",value:b.UC.CUSTOM}),e.selectedRetentionTimeOption===b.UC.CUSTOM&&(0,n.jsx)(h.J,{name:"retention-ms",topicData:e,setTopicData:t,onToggle:e=>{s(e)},isOpen:o,selectOptions:g.i}),(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionTimeOption===b.UC.UNLIMITED,name:"radioUnlimitedTime",onChange:()=>m(b.UC.UNLIMITED),label:"Unlimited","aria-label":"Unlimited",id:"radio-controlled-3",value:b.UC.UNLIMITED})]}))})),(0,n.jsx)(r.FormGroup,Object.assign({fieldId:"form-group-retention-size-in-wizard",label:"Retention size"},{children:(0,n.jsxs)(r.Stack,Object.assign({hasGutter:!0},{children:[(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionSizeOption===b.KP.UNLIMITED,name:"radioUnlimitedSize",onChange:()=>p(b.KP.UNLIMITED),label:"Unlimited","aria-label":"Unlimited",id:"radio-controlled-6",value:b.KP.UNLIMITED}),(0,n.jsx)(r.Radio,{isChecked:e.selectedRetentionSizeOption===b.KP.CUSTOM,name:"radioCustomSize",onChange:()=>p(b.KP.CUSTOM),label:"Custom size","aria-label":"custom input",id:"radio-controlled-5",value:b.KP.CUSTOM}),e.selectedRetentionSizeOption===b.KP.CUSTOM&&(0,n.jsx)(h.J,{name:"retention-bytes",topicData:e,setTopicData:t,onToggle:e=>{d(e)},isOpen:l,selectOptions:g.W})]}))}))]}))}))})};var k=i(76153);const O=({replicationFactor:e,minInSyncReplica:t,isMultiAZ:i})=>{const{t:a}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]);return(0,n.jsx)(r.Form,{children:(0,n.jsxs)(r.FormSection,Object.assign({title:a("common.replicas"),id:"replica-section",titleElement:"h2"},{children:[(0,n.jsxs)(r.TextContent,{children:[(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.p},{children:a("topic.replicas_info")})),(0,n.jsx)(r.Text,Object.assign({component:r.TextVariants.small},{children:a("topic.replicas_detail")}))]}),(0,n.jsx)(r.Alert,{variant:"info",isInline:!0,title:a(i?"topic.replicas_helper_text_multi_az":"topic.replicas_helper_text_single_az")}),(0,n.jsx)(k.R,{fieldId:"replicas",btnAriaLabel:a("common.replicas"),fieldLabel:a("common.replicas"),fieldValue:e.toString(),popoverBody:a("topic.replicas_description"),popoverHeader:a("topic.replicas")}),(0,n.jsx)(k.R,{fieldId:"min-insync-replicas",btnAriaLabel:"topic detail min-in-sync replica",fieldLabel:"Minimum in-sync replicas",fieldValue:t.toString(),popoverBody:a("topic.min_insync_replicas_description"),popoverHeader:a("topic.min_insync_replicas")})]}))})};var C=i(50334);const v=({isLoading:e,onValidate:t,topicNameValidated:i,closeWizard:a})=>{const{t:o}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]);return(0,n.jsx)(r.WizardFooter,{children:(0,n.jsx)(r.WizardContextConsumer,{children:({activeStep:s,onNext:c,onBack:l})=>s.name==o("topic.topic_name")?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Button,Object.assign({variant:"primary",type:"submit",isLoading:e,onClick:()=>t(c),isDisabled:"default"!=i,ouiaId:"button-next"},{children:o("common.next")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-back",variant:"secondary",isDisabled:!0},{children:o("common.back")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-cancel",variant:"link",onClick:a},{children:o("common.cancel")}))]}):"Replicas"==s.name?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Button,Object.assign({variant:"primary",type:"submit",onClick:c,isLoading:e,ouiaId:"button-finish"},{children:o("common.finish")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-back",variant:"secondary",onClick:l},{children:o("common.back")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-cancel",variant:"link",onClick:a},{children:o("common.cancel")}))]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-next",variant:"primary",type:"submit",onClick:c},{children:o("common.next")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-back",variant:"secondary",onClick:l},{children:o("common.back")})),(0,n.jsx)(r.Button,Object.assign({ouiaId:"button-cancel",variant:"link",onClick:a},{children:o("common.cancel")}))]})})})};var f=i(29827),S=i(3654),_=i(64517),I=i(60540),y=i(5736);const U=({isSwitchChecked:e,onCloseCreateTopic:t})=>{const{analytics:i}=(0,m.Z)(),o=(0,a.useContext)(S.E),{t:l}=(0,c.useTranslation)(["kafkaTemporaryFixMe"]),{addAlert:p}=(0,s.useAlert)()||{addAlert:()=>{}},{replicationFactor:j=0,minInSyncReplicas:h=0,isMultiAZ:g,kafka:k}=(0,_.S)()||{};(0,a.useEffect)((()=>{i.track("RHOSAK Create Topic",{entityId:null==k?void 0:k.id,status:"prompt"})}),[i,null==k?void 0:k.id]);const U={name:"",numPartitions:"1","retention.ms":"7","retention.ms.unit":"days","retention.bytes":"1","retention.bytes.unit":"bytes","cleanup.policy":"delete",selectedRetentionTimeOption:b.UC.WEEK,selectedRetentionSizeOption:b.KP.UNLIMITED},[D,R]=(0,a.useState)("default"),[N,F]=(0,a.useState)(!1),[P,M]=(0,a.useState)(""),[w,L]=(0,a.useState)(U),z=()=>{t&&t()},E=()=>{F(!0);const t=e?["cleanup.policy"]:[],n=(0,b.az)(w,t);new f.TopicsApi(new f.Configuration({basePath:null==o?void 0:o.basePath,accessToken:null==o?void 0:o.getToken})).createTopic(n).then((()=>{i.track("RHOSAK Create Topic",{entityId:null==k?void 0:k.id,topic:n.name,status:"success"}),p({variant:r.AlertVariant.success,title:l("topic.topic_successfully_created")}),F(!1),z()})).catch((e=>{i.track("RHOSAK Create Topic",{entityId:null==k?void 0:k.id,topic:n.name,status:"failure"}),F(!1),p({variant:r.AlertVariant.danger,title:e.response.data.error_message}),z()}))},A=[{name:l("topic.topic_name"),enableNext:""!==(null==w?void 0:w.name.trim())&&"default"===D,component:(0,n.jsx)(u,{topicData:w,setTopicData:L,topicNameValidated:D,setTopicNameValidated:R,invalidText:P,setInvalidText:M})},{name:l("common.partitions"),canJumpTo:""!==(null==w?void 0:w.name.trim()),component:(0,n.jsx)(x,{topicData:w,setTopicData:L})},{name:l("topic.message_retention"),canJumpTo:""!==(null==w?void 0:w.name.trim()),component:(0,n.jsx)(T,{topicData:w,setTopicData:L})},{name:l("common.replicas"),canJumpTo:""!==(null==w?void 0:w.name.trim()),component:(0,n.jsx)(O,{replicationFactor:j,minInSyncReplica:h,isMultiAZ:g}),nextButtonText:l("common.finish")}],V=l("topic.wizard_title");return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Divider,{className:"kafka-ui--divider--FlexShrink"}),(0,n.jsx)(r.PageSection,Object.assign({variant:r.PageSectionVariants.light,hasOverflowScroll:!0},{children:(0,n.jsx)(C.W,{isCreate:!0,saveTopic:E,handleCancel:t,topicData:w,setTopicData:L})}))]}):(0,n.jsx)(r.PageSection,Object.assign({variant:r.PageSectionVariants.light,type:r.PageSectionTypes.wizard,hasOverflowScroll:!0},{children:(0,n.jsx)(r.Wizard,{navAriaLabel:`${V} steps`,mainAriaLabel:`${V} content`,steps:A,onClose:z,onSave:E,"data-testid":"topicBasicCreate-Wizard",footer:(0,n.jsx)(v,{isLoading:N,onValidate:e=>{(null==w?void 0:w.name.length)<1?(M(l("topic.required")),R("error")):"."===(null==w?void 0:w.name)||".."===(null==w?void 0:w.name)?(M(l("topic.invalid_name_with_dot")),R("error")):(F(!0),((e,t)=>{(0,d.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{(yield(0,I.BN)(e,o))&&(M(l("topic.already_exists",{name:e})),R("error"),F(!1))}catch(e){e&&(0,y.I)(e)&&404===(null===(i=e.response)||void 0===i?void 0:i.status)&&(R("default"),F(!1),t())}}))})(null==w?void 0:w.name,e))},topicNameValidated:D,closeWizard:z})})}))})};i(27958);const D=()=>{const{kafkaName:e,kafkaPageLink:t,kafkaInstanceLink:i}=(0,_.S)()||{},c=(0,o.useHistory)(),{getBasename:r}=(0,s.useBasename)()||{getBasename:()=>""},d=r(),[m,p]=(0,a.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{isSwitchChecked:m,setIsSwitchChecked:p,kafkaName:e,kafkaInstanceLink:i,kafkaPageLink:t}),(0,n.jsx)(U,{isSwitchChecked:m,onCloseCreateTopic:()=>{c.push(`${d}/topics`)}})]})}}}]);
//# sourceMappingURL=9299.9e57e07b.js.map